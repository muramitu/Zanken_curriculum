import random

# å‡ºã›ã‚‹æ‰‹ã®è¾æ›¸
hand_dict = {
    "0": "ã‚°ãƒ¼",
    "2": "ãƒãƒ§ã‚­",
    "5": "ãƒ‘ãƒ¼"
}

class Player:
    def __init__(self, hands, name):
        self.hands = hands
        self.name = name
        self.hand = ""   # åˆæœŸå€¤ã¯ç©ºæ–‡å­—ã¨ã™ã‚‹
        self.wins = 0    # å‹åˆ©æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹å†…å®¹ã‚’è¿½åŠ ã™ã‚‹

    def random_select(self):
        """ç›¸æ‰‹ç”¨ï¼šæ‰‹ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«æ±ºå®š"""
        self.hand = random.choice(list(self.hands.keys()))

    def select(self):
        """ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç”¨ï¼šæ‰‹ã‚’å…¥åŠ›ã—ã¦æ±ºå®š"""
        while True:
            choice = input("ã˜ã‚ƒã‚“ã‘ã‚“ â‡’ (0:ã‚°ãƒ¼, 2:ãƒãƒ§ã‚­, 5:ãƒ‘ãƒ¼, q:çµ‚äº†): ")
            if choice in list(self.hands.keys()) + ["q"]:
                self.hand = choice
                return
            else:
                print("æƒ³å®šå¤–ã®æ‰‹ã§ã™ã€‚{}ã®ä¸­ã‹ã‚‰å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
                      .format(list(self.hands.keys()) + ["q"]))

    def show(self):
        """ç¾åœ¨ã®æ‰‹ã‚’è¡¨ç¤º"""
        if self.hand in self.hands:
            print("{}ã®æ‰‹ï¼š{}".format(self.name, self.hands[self.hand]))
        elif self.hand == "q":
            print("{}ã¯ã‚²ãƒ¼ãƒ çµ‚äº†ã‚’é¸æŠã—ã¾ã—ãŸã€‚".format(self.name))

    def win_lose_check(self, enemy_hand):
        """å‹æ•—åˆ¤å®š: å‹ã¡ãªã‚‰ True, è² ã‘ãƒ»ã‚ã„ã“ã¯ False"""
        if self.hand == enemy_hand:
            return None  # å¼•ãåˆ†ã‘
        if (self.hand == "0" and enemy_hand == "2") or \
           (self.hand == "2" and enemy_hand == "5") or \
           (self.hand == "5" and enemy_hand == "0"):
            return True
        return False


# ===== ãƒ¡ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼ =====
def main():
    print("Game Start")

    player = Player(hand_dict, "ã‚ãªãŸ")
    computer = Player(hand_dict, "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿")

    while True:
        # ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ‰‹ã‚’æ±ºå®šã™ã‚‹
                player.select()
        if player.hand == "q":
            print("å¼·åˆ¶çµ‚äº†ã—ã¾ã™")
            break

        # ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®æ‰‹ã‚’æ±ºå®šã™ã‚‹
        computer.random_select()

        # å‡ºã™æ‰‹ã‚’è¡¨ç¤ºã™ã‚‹
        player.show()
        computer.show()

        # å‹æ•—åˆ¤å®š
        result = player.win_lose_check(computer.hand)

        if result is None:
            print("Draw!!!")
        elif result:
            print("You Win!!!")
            player.wins += 1
        else:
            print("You Lose!!!")

        print("ç¾åœ¨ã®å‹åˆ©æ•°:", player.wins)

        # å‹åˆ©æ•°ãŒ3ã‚’è¶…ãˆãŸã‚‰ã‚²ãƒ¼ãƒ çµ‚äº†
        if player.wins > 3:
            print("ğŸ‰ 3å‹é”æˆï¼ã‚²ãƒ¼ãƒ çµ‚äº†ï¼")
            break


if __name__ == "__main__":
    main()
